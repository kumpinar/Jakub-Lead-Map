<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Lead Map</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.4.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.4.0/mapbox-gl.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/monday-sdk-js/dist/main.js"></script>

    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }

        .rounded-rect {
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 50px -25px black;
        }

        .flex-center {
            position: absolute;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .flex-center.left {
            left: 0px;
        }

        .sidebar-content {
            position: absolute;
            width: 95%;
            height: 95%;
            font-family: Arial, Helvetica, sans-serif;
            font-size: 32px;
            color: gray;
        }

        .sidebar-toggle {
            position: absolute;
            width: 1.3em;
            height: 1.3em;
            overflow: visible;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .sidebar-toggle.left {
            right: -1.5em;
        }


        .sidebar-toggle:hover {
            color: #0aa1cf;
            cursor: pointer;
        }

        .sidebar {
            transition: transform 1s;
            z-index: 1;
            width: 300px;
            height: 100%;
        }

        /*
The sidebar styling has them "expanded" by default, we use CSS transforms to push them offscreen
The toggleSidebar() function removes this class from the element in order to expand it.
*/
        .left.collapsed {
            transform: translateX(-295px);
        }

        #colors-legend span {
            border-radius: 3px;
            display: inline-block;
            height: 20px;
            margin-right: 5px;
            margin-bottom: 5px;
            width: 100%;
            display: block;
        }

        .legend {
            font-size: 16px;
            height: 85%;
            position: fixed;
            margin: 5px 5px 5px 5px;
            overflow: auto;
            padding: 10px;
        }

        #countries-legend div span.color {
            border-radius: 50%;
            display: inline-block;
            height: 20px;
            margin-right: 5px;
            width: 20px;
        }

        #title {
            font-size: 22px;
            font-weight: bolder;
            margin-bottom: 10px;
            text-align: center;
        }
    </style>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDsnXEGVGThb-OnBXG20PjFvRMdgFw-vDc",
            authDomain: "lemon-lead-map.firebaseapp.com",
            projectId: "lemon-lead-map",
            storageBucket: "lemon-lead-map.appspot.com",
            messagingSenderId: "1095389983309",
            appId: "1:1095389983309:web:5eb6344c31006cdb8e6204"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
    </script>
</head>

<body>

    <div id="map">
        <div id="left" class="sidebar flex-center left collapsed">
            <div class="sidebar-content rounded-rect flex-center">
                <div class="legend">
                    <b>Countries</b>
                    <div id="countries">
                        

                    </div>
                    <b>Industries</b>
                    <div id="industries">
                    </div>
                    <b>Leads</b>
                    <div id="leads">
                    </div>
                    <b>Clients</b>
                    <div id="clients">
                    </div>
                </div>
                <div id="sidebar-arrow" class="sidebar-toggle rounded-rect left" onclick="toggleSidebar('left')">
                    &rarr;
                </div>
            </div>
        </div>
    </div>

    <script>
        mapboxgl.accessToken = 'pk.eyJ1IjoieWFycmFyYW5nZXMiLCJhIjoiY2tydHpnM2pwOXdldzJubDM1b2dvcm15cCJ9.sAkVnbCzwrVLLRi7xxiHnA';
        let mondayToken='';
        // Create a new map.
        const map = new mapboxgl.Map({
            container: 'map',
            // Choose from Mapbox's core styles, or make your own style with Mapbox Studio
            style: 'mapbox://styles/mapbox/streets-v12',
            center: [
                21.00489285129794,
                52.212130350909234
            ],
            zoom: 5
        });

        map.on('load', () => {

            toggleSidebar('left');

            // Add a source for the state polygons.
            map.addSource('states', {
                'type': 'geojson',
                'data': 'https://docs.mapbox.com/mapbox-gl-js/assets/ne_110m_admin_1_states_provinces_shp.geojson'
            });

            // Add a layer showing the state polygons.
            map.addLayer({
                'id': 'states-layer',
                'type': 'fill',
                'source': 'states',
                'paint': {
                    'fill-color': 'rgba(200, 100, 240, 0.4)',
                    'fill-outline-color': 'rgba(200, 100, 240, 1)'
                }
            });

            map.on('mouseenter', 'states-layer', () => {
                map.getCanvas().style.cursor = 'pointer';
            });

            map.on('mouseleave', 'states-layer', () => {
                map.getCanvas().style.cursor = '';
            });
        });

        const monday = window.mondaySdk();

        let query = `query GetBoardItems{  
        boards(ids: 1410697073) {  
            name
            groups(ids: ["nowa_grupa36356"]){
                title
                items_page {  
                    items {  
                        id  
                        name 
                        column_values(ids: ["email", "tekst7"]) {  
                            id  
                            value  
                        }  
                    }  
                }  
            }
        }  
        }`;

        monday.api(query, {
            apiVersion: '2023-10',
            token: mondayToken
        }).then(res => {
            console.log('result');
            console.log(res);
        });




        function toggleSidebar(id) {
            const elem = document.getElementById(id);
            const collapsed = elem.classList.toggle('collapsed');
            const padding = {};
            padding[id] = collapsed ? 0 : 300; 
            const sidebarArrow = document.getElementById('sidebar-arrow');
            sidebarArrow.innerHTML = collapsed ? '&rarr;' : '&larr;';
            map.easeTo({
                padding: padding,
                duration: 1000 
            });
        }
    </script>

</body>

</html>